"use strict";const e=require("../../common/vendor.js"),a=require("../../stores/child.js"),o=require("../../stores/content.js"),n=require("../../api/content.js"),s=require("../../config/nurseryRhymeConfig.js");Math||(t+g+r)();const r=()=>"../../components/GeneratingProgress/GeneratingProgress.js",t=()=>"../../components/CreationModeSelector/CreationModeSelector.js",g=()=>"../../components/NurseryRhymeAdvanced/NurseryRhymeAdvanced.js",i=e.defineComponent({__name:"nursery-rhyme",setup(r){const t=a.useChildStore();o.useContentStore();const g=e.ref(!0),i=e.ref(!1),l=e.ref(""),u=e.ref(20),d=e.ref(88),c=[{id:"theme",name:"é€‰ä¸»é¢˜"},{id:"style",name:"é€‰é£æ ¼"},{id:"confirm",name:"ç¡®è®¤"}],_=e.ref(0),m=[{id:"habit",name:"ä¹ æƒ¯å…»æˆ",icon:"ğŸŒŸ"},{id:"cognition",name:"è®¤çŸ¥å¯è’™",icon:"ğŸŒ"},{id:"action",name:"å¾‹åŠ¨æ¸¸æˆ",icon:"ğŸµ"},{id:"scene",name:"æ—¥å¸¸åœºæ™¯",icon:"ğŸ "},{id:"nature",name:"è‡ªç„¶ä¸–ç•Œ",icon:"ğŸŒ¸"},{id:"festival",name:"èŠ‚æ—¥æ­Œæ›²",icon:"ğŸ‰"}],y=e.ref("habit"),v=e.ref(null),b=s.SCENE_PRESETS,p=e.ref(null),f=e.ref(!0),w=s.MUSIC_MOODS,k=e.ref("cheerful"),h=s.VOCAL_TYPES,S=e.ref("soft_female"),T=e.reactive({...s.DEFAULT_PARAMS}),P=e.computed(()=>k.value);e.computed(()=>[{id:"time",name:"æŒ‰æ—¶æ®µ",presets:b.filter(e=>"time"===e.category)},{id:"function",name:"æŒ‰åŠŸèƒ½",presets:b.filter(e=>"function"===e.category)},{id:"mood",name:"æŒ‰æ°›å›´",presets:b.filter(e=>"mood"===e.category)}]);const C=e.ref(!1),x=e.ref(0),E=e.ref("waiting"),M=e.ref(""),O=e.ref(0),A=e.ref(null);let I=null;const R={waiting:{minProgress:1,maxProgress:30,message:"æ­£åœ¨ç”Ÿæˆæ­Œè¯æ–‡æœ¬..."},text:{minProgress:35,maxProgress:65,message:"æ–‡æœ¬å®Œæˆï¼Œæ­£åœ¨ç”ŸæˆéŸ³ä¹..."},first:{minProgress:70,maxProgress:90,message:"é¦–æ›²å®Œæˆï¼Œç»§ç»­ç”Ÿæˆ..."},complete:{minProgress:100,maxProgress:100,message:"å…¨éƒ¨å®Œæˆï¼"},error:{minProgress:0,maxProgress:0,message:"ç”Ÿæˆå¤±è´¥"},pending:{minProgress:1,maxProgress:30,message:"æ­£åœ¨ç”Ÿæˆæ­Œè¯æ–‡æœ¬..."},processing:{minProgress:35,maxProgress:65,message:"æ­£åœ¨ç”ŸæˆéŸ³ä¹..."},generating:{minProgress:35,maxProgress:65,message:"æ­£åœ¨ç”ŸæˆéŸ³ä¹..."},queued:{minProgress:1,maxProgress:15,message:"æ’é˜Ÿä¸­..."},submitted:{minProgress:1,maxProgress:20,message:"å·²æäº¤ï¼Œç­‰å¾…å¤„ç†..."}},j=e.computed(()=>{var e;return(null==(e=t.currentChild)?void 0:e.name)||"å®è´"}),N=e.computed(()=>{let e=z[y.value]||[];if(v.value&&v.value.id){if(!e.some(e=>e.id===v.value.id)){const a=e.find(e=>e.id===v.value.id);a&&(e=[a,...e])}}return e});e.computed(()=>{const e=m.find(e=>e.id===y.value);return(null==e?void 0:e.name)||""});const U=e.computed(()=>{var e;return(null==(e=w.find(e=>e.value===k.value))?void 0:e.label)||""}),L=e.computed(()=>{var e;return(null==(e=h.find(e=>e.value===S.value))?void 0:e.label)||""}),G=e.computed(()=>{const e=[];if(p.value){const a=b.find(e=>e.id===p.value);a&&e.push({label:"åœºæ™¯é¢„è®¾",value:a.name,icon:a.icon})}if(T.music_genre){const a=s.MUSIC_GENRES.flatMap(e=>e.options).find(e=>e.value===T.music_genre);a&&e.push({label:"éŸ³ä¹æµæ´¾",value:a.label,icon:"ğŸµ"})}if(T.tempo&&100!==T.tempo&&e.push({label:"èŠ‚å¥é€Ÿåº¦",value:`${T.tempo} BPM Â· ${s.getTempoHint(T.tempo)}`,icon:"â±ï¸"}),T.energy_level&&5!==T.energy_level&&e.push({label:"èƒ½é‡å¼ºåº¦",value:s.getEnergyHint(T.energy_level),icon:"âš¡"}),T.vocal_range){const a=s.VOCAL_RANGES.find(e=>e.value===T.vocal_range);a&&e.push({label:"éŸ³åŸŸ",value:a.label,icon:"ğŸ¤"})}if(T.vocal_emotion){const a=s.VOCAL_EMOTIONS.find(e=>e.value===T.vocal_emotion);a&&e.push({label:"æƒ…æ„Ÿè¡¨è¾¾",value:a.label,icon:"ğŸ’«"})}if(T.vocal_style){const a=s.VOCAL_TECHNIQUES.find(e=>e.value===T.vocal_style);a&&e.push({label:"æ¼”å”±æŠ€å·§",value:a.label,icon:"ğŸ¶"})}if(T.song_structure){const a=s.SONG_STRUCTURES.find(e=>e.value===T.song_structure);a&&e.push({label:"æ­Œæ›²ç»“æ„",value:`${a.label} (${a.description})`,icon:"ğŸ¼"})}if(T.action_types){const a=s.ACTION_TYPES.find(e=>e.value===T.action_types);a&&e.push({label:"åŠ¨ä½œæŒ‡å¼•",value:a.label,icon:a.icon})}if(T.language&&"zh"!==T.language){const a=s.LANGUAGES.flatMap(e=>e.options).find(e=>e.value===T.language);a&&e.push({label:"æ­Œæ›²è¯­è¨€",value:a.label,icon:"ğŸŒ"})}if(T.educational_focus){const a=s.EDUCATIONAL_FOCUS.flatMap(e=>e.options).find(e=>e.value===T.educational_focus);a&&e.push({label:"æ•™è‚²ç›®æ ‡",value:a.label,icon:"ğŸ“š"})}if(T.instruments&&T.instruments.length>0){const a=s.INSTRUMENTS_BY_FAMILY.flatMap(e=>e.options),o=T.instruments.map(e=>{var o;return null==(o=a.find(a=>a.value===e))?void 0:o.label}).filter(Boolean).slice(0,3);if(o.length>0){const a=o.join("ã€")+(T.instruments.length>3?"...":"");e.push({label:"ä¹å™¨é…ç½®",value:a,icon:"ğŸ¹"})}}if(T.sound_effects&&T.sound_effects.length>0){const a=s.SOUND_EFFECTS.flatMap(e=>e.options),o=T.sound_effects.map(e=>{var o;return null==(o=a.find(a=>a.value===e))?void 0:o.label}).filter(Boolean).slice(0,3);if(o.length>0){const a=o.join("ã€")+(T.sound_effects.length>3?"...":"");e.push({label:"éŸ³æ•ˆå…ƒç´ ",value:a,icon:"ğŸ”Š"})}}if(T.lyric_complexity&&5!==T.lyric_complexity&&e.push({label:"æ­Œè¯å¤æ‚åº¦",value:s.getLyricComplexityHint(T.lyric_complexity),icon:"ğŸ“"}),T.repetition_level&&6!==T.repetition_level&&e.push({label:"é‡å¤ç¨‹åº¦",value:s.getRepetitionHint(T.repetition_level),icon:"ğŸ”"}),T.cultural_style){const a=s.CULTURAL_STYLES.flatMap(e=>e.options).find(e=>e.value===T.cultural_style);a&&e.push({label:"æ–‡åŒ–é£æ ¼",value:a.label,icon:"ğŸ­"})}if(T.favorite_colors&&T.favorite_colors.length>0){const a=s.FAVORITE_COLORS.flatMap(e=>e.options),o=T.favorite_colors.map(e=>{const o=a.find(a=>a.value===e);return o?`${o.icon}${o.label}`:null}).filter(Boolean).slice(0,4);o.length>0&&e.push({label:"å–œæ¬¢çš„é¢œè‰²",value:o.join(" "),icon:"ğŸ¨"})}return void 0!==T.style_weight&&.5!==T.style_weight&&e.push({label:"é£æ ¼æƒé‡",value:`${Math.round(100*T.style_weight)}%`,icon:"ğŸ›ï¸"}),void 0!==T.creativity&&.5!==T.creativity&&e.push({label:"åˆ›æ„ç¨‹åº¦",value:`${Math.round(100*T.creativity)}%`,icon:"âœ¨"}),e});function q(e){Object.assign(T,e)}const $=e.computed(()=>0!==_.value||!!v.value),z={habit:[{id:"brush_teeth",name:"åˆ·ç‰™æ­Œ",subcategory:"å«ç”Ÿä¹ æƒ¯",age_range:[24,48],keywords:[]},{id:"wash_hands",name:"æ´—æ‰‹æ­Œ",subcategory:"å«ç”Ÿä¹ æƒ¯",age_range:[18,48],keywords:[]},{id:"take_bath",name:"æ´—æ¾¡æ­Œ",subcategory:"å«ç”Ÿä¹ æƒ¯",age_range:[18,48],keywords:[]},{id:"wash_face",name:"æ´—è„¸æ­Œ",subcategory:"å«ç”Ÿä¹ æƒ¯",age_range:[18,36],keywords:[]},{id:"cut_nails",name:"å‰ªæŒ‡ç”²",subcategory:"å«ç”Ÿä¹ æƒ¯",age_range:[24,48],keywords:[]},{id:"get_dressed",name:"ç©¿è¡£æ­Œ",subcategory:"ç”Ÿæ´»è‡ªç†",age_range:[24,48],keywords:[]},{id:"tie_shoes",name:"ç³»é‹å¸¦",subcategory:"ç”Ÿæ´»è‡ªç†",age_range:[48,72],keywords:[]},{id:"potty_song",name:"ä¸Šå•æ‰€",subcategory:"ç”Ÿæ´»è‡ªç†",age_range:[18,36],keywords:[]},{id:"eat_well",name:"åƒé¥­æ­Œ",subcategory:"é¥®é£Ÿä¹ æƒ¯",age_range:[18,48],keywords:[]},{id:"no_picky",name:"ä¸æŒ‘é£Ÿ",subcategory:"é¥®é£Ÿä¹ æƒ¯",age_range:[24,60],keywords:[]},{id:"drink_water",name:"å¤šå–æ°´",subcategory:"å¥åº·ä¹ æƒ¯",age_range:[18,48],keywords:[]},{id:"chew_slowly",name:"ç»†åš¼æ…¢å’½",subcategory:"é¥®é£Ÿä¹ æƒ¯",age_range:[24,60],keywords:[]},{id:"sleep_song",name:"ç¡è§‰æ­Œ",subcategory:"ä½œæ¯ä¹ æƒ¯",age_range:[18,48],keywords:[]},{id:"wake_up",name:"èµ·åºŠæ­Œ",subcategory:"ä½œæ¯ä¹ æƒ¯",age_range:[18,48],keywords:[]},{id:"nap_song",name:"åˆç¡æ­Œ",subcategory:"ä½œæ¯ä¹ æƒ¯",age_range:[18,48],keywords:[]},{id:"tidy_up",name:"æ”¶æ‹¾æ­Œ",subcategory:"æ•´ç†ä¹ æƒ¯",age_range:[24,60],keywords:[]},{id:"clean_room",name:"æ•´ç†æˆ¿é—´",subcategory:"æ•´ç†ä¹ æƒ¯",age_range:[36,72],keywords:[]},{id:"polite_song",name:"ç¤¼è²Œæ­Œ",subcategory:"ç¤¼ä»ªä¹ æƒ¯",age_range:[18,48],keywords:[]},{id:"share_song",name:"åˆ†äº«æ­Œ",subcategory:"ç¤¾äº¤ä¹ æƒ¯",age_range:[24,60],keywords:[]},{id:"exercise_song",name:"è¿åŠ¨æ­Œ",subcategory:"å¥åº·ä¹ æƒ¯",age_range:[24,60],keywords:[]}],cognition:[{id:"numbers",name:"æ•°å­—æ­Œ",subcategory:"æ•°å­¦å¯è’™",age_range:[24,48],keywords:[]},{id:"counting",name:"æ•°æ•°æ­Œ",subcategory:"æ•°å­¦å¯è’™",age_range:[18,48],keywords:[]},{id:"add_subtract",name:"åŠ å‡æ­Œ",subcategory:"æ•°å­¦å¯è’™",age_range:[48,72],keywords:[]},{id:"letters",name:"å­—æ¯æ­Œ",subcategory:"è¯­è¨€å¯è’™",age_range:[30,60],keywords:[]},{id:"pinyin",name:"æ‹¼éŸ³æ­Œ",subcategory:"è¯­è¨€å¯è’™",age_range:[48,72],keywords:[]},{id:"colors",name:"é¢œè‰²æ­Œ",subcategory:"åŸºç¡€è®¤çŸ¥",age_range:[12,36],keywords:[]},{id:"shapes",name:"å½¢çŠ¶æ­Œ",subcategory:"åŸºç¡€è®¤çŸ¥",age_range:[18,36],keywords:[]},{id:"big_small",name:"å¤§å°æ­Œ",subcategory:"å¯¹æ¯”è®¤çŸ¥",age_range:[12,36],keywords:[]},{id:"long_short",name:"é•¿çŸ­æ­Œ",subcategory:"å¯¹æ¯”è®¤çŸ¥",age_range:[18,36],keywords:[]},{id:"body_parts",name:"èº«ä½“æ­Œ",subcategory:"è‡ªæˆ‘è®¤çŸ¥",age_range:[12,36],keywords:[]},{id:"five_senses",name:"äº”å®˜æ­Œ",subcategory:"è‡ªæˆ‘è®¤çŸ¥",age_range:[12,36],keywords:[]},{id:"opposites",name:"åä¹‰è¯",subcategory:"è¯­è¨€å¯è’™",age_range:[24,48],keywords:[]},{id:"animals",name:"åŠ¨ç‰©æ­Œ",subcategory:"è‡ªç„¶è®¤çŸ¥",age_range:[12,48],keywords:[]},{id:"animal_sounds",name:"åŠ¨ç‰©å«",subcategory:"è‡ªç„¶è®¤çŸ¥",age_range:[12,36],keywords:[]},{id:"fruits",name:"æ°´æœæ­Œ",subcategory:"ç”Ÿæ´»è®¤çŸ¥",age_range:[12,36],keywords:[]},{id:"vegetables",name:"è”¬èœæ­Œ",subcategory:"ç”Ÿæ´»è®¤çŸ¥",age_range:[18,48],keywords:[]},{id:"vehicles",name:"äº¤é€šæ­Œ",subcategory:"ç”Ÿæ´»è®¤çŸ¥",age_range:[18,48],keywords:[]},{id:"occupations",name:"èŒä¸šæ­Œ",subcategory:"ç¤¾ä¼šè®¤çŸ¥",age_range:[30,60],keywords:[]},{id:"family",name:"å®¶äººæ­Œ",subcategory:"ç¤¾ä¼šè®¤çŸ¥",age_range:[12,36],keywords:[]},{id:"time_song",name:"æ—¶é—´æ­Œ",subcategory:"åŸºç¡€è®¤çŸ¥",age_range:[42,72],keywords:[]}],action:[{id:"clap_hands",name:"æ‹æ‰‹æ­Œ",subcategory:"æ‰‹éƒ¨å¾‹åŠ¨",age_range:[12,36],keywords:[]},{id:"finger_play",name:"æ‰‹æŒ‡æ­Œ",subcategory:"æ‰‹éƒ¨å¾‹åŠ¨",age_range:[12,48],keywords:[]},{id:"finger_family",name:"æ‰‹æŒ‡å®¶æ—",subcategory:"æ‰‹éƒ¨å¾‹åŠ¨",age_range:[12,36],keywords:[]},{id:"fist_song",name:"æ¡æ‹³æ­Œ",subcategory:"æ‰‹éƒ¨å¾‹åŠ¨",age_range:[12,36],keywords:[]},{id:"dance_song",name:"è·³èˆæ­Œ",subcategory:"å…¨èº«å¾‹åŠ¨",age_range:[24,60],keywords:[]},{id:"march_song",name:"è¸æ­¥æ­Œ",subcategory:"å…¨èº«å¾‹åŠ¨",age_range:[18,48],keywords:[]},{id:"jump_song",name:"è·³è·³æ­Œ",subcategory:"å…¨èº«å¾‹åŠ¨",age_range:[24,60],keywords:[]},{id:"stretch_song",name:"ä¼¸å±•æ­Œ",subcategory:"å…¨èº«å¾‹åŠ¨",age_range:[18,48],keywords:[]},{id:"spin_song",name:"è½¬åœˆæ­Œ",subcategory:"å…¨èº«å¾‹åŠ¨",age_range:[24,48],keywords:[]},{id:"squat_song",name:"è¹²èµ·æ­Œ",subcategory:"å…¨èº«å¾‹åŠ¨",age_range:[24,60],keywords:[]},{id:"shake_song",name:"æ‘‡æ‘‡æ­Œ",subcategory:"å…¨èº«å¾‹åŠ¨",age_range:[12,36],keywords:[]},{id:"hide_seek",name:"æ‰è¿·è—",subcategory:"äº’åŠ¨æ¸¸æˆ",age_range:[24,60],keywords:[]},{id:"follow_me",name:"è·Ÿæˆ‘åš",subcategory:"äº’åŠ¨æ¸¸æˆ",age_range:[18,48],keywords:[]},{id:"pass_ball",name:"ä¼ çƒæ­Œ",subcategory:"äº’åŠ¨æ¸¸æˆ",age_range:[24,60],keywords:[]},{id:"action_song",name:"åŠ¨ä½œæ­Œ",subcategory:"åŠ¨ä½œæ¨¡ä»¿",age_range:[18,48],keywords:[]},{id:"animal_move",name:"åŠ¨ç‰©æ“",subcategory:"åŠ¨ä½œæ¨¡ä»¿",age_range:[24,60],keywords:[]},{id:"robot_dance",name:"æœºå™¨äººèˆ",subcategory:"åŠ¨ä½œæ¨¡ä»¿",age_range:[30,60],keywords:[]},{id:"rhythm_game",name:"èŠ‚å¥æ­Œ",subcategory:"èŠ‚å¥æ„Ÿ",age_range:[24,60],keywords:[]},{id:"drum_song",name:"æ‰“é¼“æ­Œ",subcategory:"èŠ‚å¥æ„Ÿ",age_range:[18,48],keywords:[]},{id:"freeze_dance",name:"å®šæ ¼èˆ",subcategory:"äº’åŠ¨æ¸¸æˆ",age_range:[30,60],keywords:[]}],scene:[{id:"morning_song",name:"æ—©å®‰æ­Œ",subcategory:"ä¸€å¤©æ—¶å…‰",age_range:[18,48],keywords:[]},{id:"goodnight",name:"æ™šå®‰æ­Œ",subcategory:"ä¸€å¤©æ—¶å…‰",age_range:[12,48],keywords:[]},{id:"lullaby",name:"æ‘‡ç¯®æ›²",subcategory:"ç¡å‰æ­Œæ›²",age_range:[0,36],keywords:[]},{id:"sweet_dreams",name:"ç”œæ¢¦æ­Œ",subcategory:"ç¡å‰æ­Œæ›²",age_range:[0,36],keywords:[]},{id:"car_ride",name:"åè½¦æ­Œ",subcategory:"å‡ºè¡Œåœºæ™¯",age_range:[18,48],keywords:[]},{id:"bus_song",name:"åå…¬äº¤",subcategory:"å‡ºè¡Œåœºæ™¯",age_range:[24,60],keywords:[]},{id:"train_ride",name:"åç«è½¦",subcategory:"å‡ºè¡Œåœºæ™¯",age_range:[24,60],keywords:[]},{id:"playground",name:"æ¸¸ä¹åœº",subcategory:"æ¸¸ç©åœºæ™¯",age_range:[24,60],keywords:[]},{id:"zoo_trip",name:"åŠ¨ç‰©å›­",subcategory:"æ¸¸ç©åœºæ™¯",age_range:[24,60],keywords:[]},{id:"aquarium",name:"æ°´æ—é¦†",subcategory:"æ¸¸ç©åœºæ™¯",age_range:[24,60],keywords:[]},{id:"supermarket",name:"è¶…å¸‚æ­Œ",subcategory:"ç”Ÿæ´»åœºæ™¯",age_range:[24,60],keywords:[]},{id:"hospital",name:"çœ‹åŒ»ç”Ÿ",subcategory:"ç”Ÿæ´»åœºæ™¯",age_range:[24,60],keywords:[]},{id:"haircut",name:"ç†å‘æ­Œ",subcategory:"ç”Ÿæ´»åœºæ™¯",age_range:[24,60],keywords:[]},{id:"school_song",name:"ä¸Šå­¦æ­Œ",subcategory:"æ ¡å›­ç”Ÿæ´»",age_range:[30,72],keywords:[]},{id:"homework",name:"åšä½œä¸š",subcategory:"æ ¡å›­ç”Ÿæ´»",age_range:[48,72],keywords:[]},{id:"recess",name:"è¯¾é—´æ­Œ",subcategory:"æ ¡å›­ç”Ÿæ´»",age_range:[36,72],keywords:[]},{id:"picnic",name:"é‡é¤æ­Œ",subcategory:"æˆ·å¤–æ´»åŠ¨",age_range:[24,60],keywords:[]},{id:"beach_song",name:"æµ·è¾¹æ­Œ",subcategory:"æˆ·å¤–æ´»åŠ¨",age_range:[24,60],keywords:[]},{id:"park_song",name:"å…¬å›­æ­Œ",subcategory:"æˆ·å¤–æ´»åŠ¨",age_range:[18,48],keywords:[]},{id:"camping",name:"éœ²è¥æ­Œ",subcategory:"æˆ·å¤–æ´»åŠ¨",age_range:[30,72],keywords:[]}],nature:[{id:"sun_song",name:"å¤ªé˜³æ­Œ",subcategory:"å¤©ä½“",age_range:[18,48],keywords:[]},{id:"moon_song",name:"æœˆäº®æ­Œ",subcategory:"å¤©ä½“",age_range:[18,48],keywords:[]},{id:"star_song",name:"æ˜Ÿæ˜Ÿæ­Œ",subcategory:"å¤©ä½“",age_range:[18,48],keywords:[]},{id:"earth_song",name:"åœ°çƒæ­Œ",subcategory:"å¤©ä½“",age_range:[30,60],keywords:[]},{id:"rain_song",name:"ä¸‹é›¨æ­Œ",subcategory:"å¤©æ°”",age_range:[18,48],keywords:[]},{id:"rainbow",name:"å½©è™¹æ­Œ",subcategory:"å¤©æ°”",age_range:[24,60],keywords:[]},{id:"wind_song",name:"é£å„¿æ­Œ",subcategory:"å¤©æ°”",age_range:[24,60],keywords:[]},{id:"cloud_song",name:"äº‘æœµæ­Œ",subcategory:"å¤©æ°”",age_range:[18,48],keywords:[]},{id:"snow_song",name:"ä¸‹é›ªæ­Œ",subcategory:"å¤©æ°”",age_range:[24,60],keywords:[]},{id:"thunder",name:"æ‰“é›·æ­Œ",subcategory:"å¤©æ°”",age_range:[24,60],keywords:[]},{id:"spring_song",name:"æ˜¥å¤©æ­Œ",subcategory:"å››å­£",age_range:[24,60],keywords:[]},{id:"summer_song",name:"å¤å¤©æ­Œ",subcategory:"å››å­£",age_range:[24,60],keywords:[]},{id:"autumn_song",name:"ç§‹å¤©æ­Œ",subcategory:"å››å­£",age_range:[24,60],keywords:[]},{id:"winter_song",name:"å†¬å¤©æ­Œ",subcategory:"å››å­£",age_range:[24,60],keywords:[]},{id:"flower_song",name:"èŠ±å„¿æ­Œ",subcategory:"æ¤ç‰©",age_range:[18,48],keywords:[]},{id:"tree_song",name:"å¤§æ ‘æ­Œ",subcategory:"æ¤ç‰©",age_range:[18,48],keywords:[]},{id:"grass_song",name:"å°è‰æ­Œ",subcategory:"æ¤ç‰©",age_range:[18,48],keywords:[]},{id:"butterfly",name:"è´è¶æ­Œ",subcategory:"æ˜†è™«",age_range:[18,48],keywords:[]},{id:"bee_song",name:"å°èœœèœ‚",subcategory:"æ˜†è™«",age_range:[18,48],keywords:[]},{id:"bird_song",name:"å°é¸Ÿæ­Œ",subcategory:"åŠ¨ç‰©",age_range:[12,48],keywords:[]}],festival:[{id:"birthday_song",name:"ç”Ÿæ—¥æ­Œ",subcategory:"ç‰¹æ®Šæ—¥å­",age_range:[12,72],keywords:[]},{id:"happy_birthday",name:"ç¥ä½ ç”Ÿæ—¥",subcategory:"ç‰¹æ®Šæ—¥å­",age_range:[12,72],keywords:[]},{id:"new_year_song",name:"æ–°å¹´æ­Œ",subcategory:"ä¸­å›½èŠ‚æ—¥",age_range:[18,72],keywords:[]},{id:"spring_fest",name:"è¿‡å¹´æ­Œ",subcategory:"ä¸­å›½èŠ‚æ—¥",age_range:[18,72],keywords:[]},{id:"red_envelope",name:"çº¢åŒ…æ­Œ",subcategory:"ä¸­å›½èŠ‚æ—¥",age_range:[18,72],keywords:[]},{id:"lantern_song",name:"å…ƒå®µæ­Œ",subcategory:"ä¸­å›½èŠ‚æ—¥",age_range:[24,72],keywords:[]},{id:"dragon_boat",name:"ç«¯åˆæ­Œ",subcategory:"ä¸­å›½èŠ‚æ—¥",age_range:[24,72],keywords:[]},{id:"moon_fest",name:"ä¸­ç§‹æ­Œ",subcategory:"ä¸­å›½èŠ‚æ—¥",age_range:[24,72],keywords:[]},{id:"qingming",name:"æ¸…æ˜æ­Œ",subcategory:"ä¸­å›½èŠ‚æ—¥",age_range:[36,72],keywords:[]},{id:"double_ninth",name:"é‡é˜³æ­Œ",subcategory:"ä¸­å›½èŠ‚æ—¥",age_range:[36,72],keywords:[]},{id:"childrens_day",name:"å„¿ç«¥èŠ‚",subcategory:"ç‰¹æ®ŠèŠ‚æ—¥",age_range:[24,72],keywords:[]},{id:"teachers_day",name:"æ•™å¸ˆèŠ‚",subcategory:"æ„Ÿæ©èŠ‚æ—¥",age_range:[36,72],keywords:[]},{id:"mothers_song",name:"æ¯äº²èŠ‚",subcategory:"æ„Ÿæ©èŠ‚æ—¥",age_range:[24,72],keywords:[]},{id:"fathers_song",name:"çˆ¶äº²èŠ‚",subcategory:"æ„Ÿæ©èŠ‚æ—¥",age_range:[24,72],keywords:[]},{id:"grandparents",name:"çˆ·çˆ·å¥¶å¥¶",subcategory:"æ„Ÿæ©èŠ‚æ—¥",age_range:[24,72],keywords:[]},{id:"christmas",name:"åœ£è¯æ­Œ",subcategory:"è¥¿æ–¹èŠ‚æ—¥",age_range:[24,72],keywords:[]},{id:"halloween",name:"ä¸‡åœ£èŠ‚",subcategory:"è¥¿æ–¹èŠ‚æ—¥",age_range:[36,72],keywords:[]},{id:"easter",name:"å¤æ´»èŠ‚",subcategory:"è¥¿æ–¹èŠ‚æ—¥",age_range:[30,72],keywords:[]},{id:"thank_song",name:"æ„Ÿæ©æ­Œ",subcategory:"æ„Ÿæ©èŠ‚æ—¥",age_range:[24,72],keywords:[]},{id:"graduation",name:"æ¯•ä¸šæ­Œ",subcategory:"ç‰¹æ®Šæ—¥å­",age_range:[48,72],keywords:[]}]},B={brush_teeth:"ğŸ¦·",wash_hands:"ğŸ§¼",take_bath:"ğŸ›",wash_face:"ğŸ§´",cut_nails:"ğŸ’…",get_dressed:"ğŸ‘•",tie_shoes:"ğŸ‘Ÿ",potty_song:"ğŸš½",eat_well:"ğŸ½ï¸",no_picky:"ğŸ¥¦",drink_water:"ğŸ’§",chew_slowly:"ğŸ´",sleep_song:"ğŸ˜´",wake_up:"ğŸŒ…",nap_song:"ğŸ’¤",tidy_up:"ğŸ§¹",clean_room:"ğŸ ",polite_song:"ğŸ’¬",share_song:"ğŸ¤",exercise_song:"ğŸƒ",numbers:"ğŸ”¢",counting:"ğŸ§®",add_subtract:"â•",letters:"ğŸ”¤",pinyin:"ğŸ“",colors:"ğŸ¨",shapes:"ğŸ”·",big_small:"ğŸ“",long_short:"ğŸ“",body_parts:"ğŸ–ï¸",five_senses:"ğŸ‘ï¸",opposites:"â†”ï¸",animals:"ğŸ¦",animal_sounds:"ğŸ•",fruits:"ğŸ",vegetables:"ğŸ¥¬",vehicles:"ğŸš—",occupations:"ğŸ‘¨â€âš•ï¸",family:"ğŸ‘¨â€ğŸ‘©â€ğŸ‘§",time_song:"ğŸ•",clap_hands:"ğŸ‘",finger_play:"ğŸ–ï¸",finger_family:"âœ‹",fist_song:"âœŠ",dance_song:"ğŸ’ƒ",march_song:"ğŸš¶",jump_song:"ğŸ¦˜",stretch_song:"ğŸ™†",spin_song:"ğŸ”„",squat_song:"ğŸ§",shake_song:"ğŸ™Œ",hide_seek:"ğŸ™ˆ",follow_me:"ğŸ‘€",pass_ball:"âš½",action_song:"ğŸ¬",animal_move:"ğŸ»",robot_dance:"ğŸ¤–",rhythm_game:"ğŸ¥",drum_song:"ğŸª˜",freeze_dance:"ğŸ§Š",morning_song:"â˜€ï¸",goodnight:"ğŸŒ™",lullaby:"ğŸ¼",sweet_dreams:"ğŸ’«",car_ride:"ğŸš—",bus_song:"ğŸšŒ",train_ride:"ğŸš‚",playground:"ğŸ¢",zoo_trip:"ğŸ¦’",aquarium:"ğŸ ",supermarket:"ğŸ›’",hospital:"ğŸ¥",haircut:"ğŸ’‡",school_song:"ğŸ’",homework:"ğŸ“š",recess:"ğŸ®",picnic:"ğŸ§º",beach_song:"ğŸ–ï¸",park_song:"ğŸŒ³",camping:"â›º",sun_song:"â˜€ï¸",moon_song:"ğŸŒ™",star_song:"â­",earth_song:"ğŸŒ",rain_song:"ğŸŒ§ï¸",rainbow:"ğŸŒˆ",wind_song:"ğŸ’¨",cloud_song:"â˜ï¸",snow_song:"â„ï¸",thunder:"âš¡",spring_song:"ğŸŒ¸",summer_song:"ğŸŒ»",autumn_song:"ğŸ‚",winter_song:"ğŸ§£",flower_song:"ğŸŒ·",tree_song:"ğŸŒ³",grass_song:"ğŸŒ¿",butterfly:"ğŸ¦‹",bee_song:"ğŸ",bird_song:"ğŸ¦",birthday_song:"ğŸ‚",happy_birthday:"ğŸ",new_year_song:"ğŸ†",spring_fest:"ğŸ§§",red_envelope:"ğŸ§§",lantern_song:"ğŸ®",dragon_boat:"ğŸ²",moon_fest:"ğŸ¥®",qingming:"ğŸŒ¾",double_ninth:"ğŸ”ï¸",childrens_day:"ğŸˆ",teachers_day:"ğŸ“–",mothers_song:"ğŸ’",fathers_song:"ğŸ‘”",grandparents:"ğŸ‘´",christmas:"ğŸ„",halloween:"ğŸƒ",easter:"ğŸ°",thank_song:"ğŸ™",graduation:"ğŸ“",potty_training:"ğŸš½",eat_independently:"ğŸ¥„",no_picky_eating:"ğŸ¥¦",bedtime:"ğŸ›ï¸",nap_time:"ğŸ˜´",sharing:"ğŸ¤",greeting:"ğŸ‘‹"};function D(e,a){g.value=!1,"smart"===e?(i.value=!0,l.value=a||"",v.value={id:"smart_custom",name:"æ™ºèƒ½åˆ›ä½œ",subcategory:"è‡ªå®šä¹‰",age_range:[12,72],keywords:[]},_.value=1):(i.value=!1,_.value=0)}function F(){_.value>0&&_.value--}async function H(){$.value&&(_.value<2?_.value++:await async function(){if(!v.value||!t.currentChild)return;C.value=!0,x.value=1,E.value="waiting",M.value="æ­£åœ¨æäº¤ç”Ÿæˆä»»åŠ¡...",O.value=0;try{const a=t.currentChildAgeMonths||36;console.log("[startGenerate] å‘èµ·å¼‚æ­¥ç”Ÿæˆè¯·æ±‚");const o={child_name:t.currentChild.name,age_months:a,theme_topic:v.value.name,theme_category:y.value,music_mood:k.value,vocal_type:S.value,...T,music_style:P.value};i.value&&l.value?(o.creation_mode="smart",o.custom_prompt=l.value,console.log("[å„¿æ­Œ] æ™ºèƒ½åˆ›ä½œæ¨¡å¼ï¼Œæè¿°:",l.value)):o.creation_mode="preset";const s=["music_genre","vocal_range","vocal_emotion","vocal_style","song_structure","action_types","language","cultural_style","educational_focus"];for(const e of s){const a=o[e];Array.isArray(a)&&(o[e]=a.length>0?a[0]:void 0)}const r=["instruments","sound_effects","vocal_effects","favorite_colors","favorite_characters","favorite_animals","inspiration_keywords"];for(const e of r){const a=o[e];(Array.isArray(a)&&0===a.length||null==a)&&delete o[e]}Object.keys(o).forEach(e=>{void 0!==o[e]&&null!==o[e]||delete o[e]}),console.log("[startGenerate] è¯·æ±‚å‚æ•°:",JSON.stringify(o,null,2));const g=await n.generateNurseryRhymeAsync(o);console.log("[startGenerate] å¼‚æ­¥è¯·æ±‚è¿”å›:",g);const u=g.task_id;if(!u)throw new Error("æœªè·å–åˆ°ä»»åŠ¡ IDï¼Œè¯·é‡è¯•");console.log("[startGenerate] è·å–åˆ° task_id:",u),M.value="AI æ­£åœ¨åˆ›ä½œæ­Œè¯...";const d=await async function(e){var a,o,s,r,g,i,l;const u=120,d=3e3,c=5;O.value=0,J(),console.log("[startSimulateProgress] å¯åŠ¨æ¨¡æ‹Ÿè¿›åº¦"),I=setInterval(()=>{const e=E.value,a=R[e];if(!a){console.log("[æ¨¡æ‹Ÿè¿›åº¦] æœªçŸ¥é˜¶æ®µ:",e,"ä½¿ç”¨é»˜è®¤è¿›åº¦èŒƒå›´");const a=x.value;if(a<95){const e=1.5*Math.random()+.5;x.value=Math.min(a+e,95)}return}const o=x.value;if(o<a.maxProgress){const e=1.5*Math.random()+.5;x.value=Math.min(o+e,a.maxProgress)}},1e3),console.log("[pollTaskStatus] å¼€å§‹è½®è¯¢ï¼ŒtaskId:",e,"æœ€å¤§å°è¯•:",u);for(let y=0;y<u;y++)try{const c=await n.getNurseryRhymeTaskStatus(e);console.log(`[pollTaskStatus] ç¬¬ ${y+1}/${u} æ¬¡è½®è¯¢ï¼ŒåŸå§‹å“åº”:`,JSON.stringify(c)),O.value=0;const m=c.stage||"waiting",b=V(m);if(console.log("[pollTaskStatus] åŸå§‹é˜¶æ®µ:",m,"-> æ ‡å‡†åŒ–:",b),b){const e=E.value;if(E.value=b,e!==b){const e=(null==(a=R[b])?void 0:a.minProgress)||0;x.value<e&&(x.value=e,console.log("[pollTaskStatus] é˜¶æ®µå˜åŒ–ï¼Œè·³è½¬åˆ°æœ€å°è¿›åº¦:",e))}}M.value=c.message||(null==(o=R[b])?void 0:o.message)||"å¤„ç†ä¸­...",console.log("[pollTaskStatus] åç«¯è¿›åº¦ï¼ˆä»…è®°å½•ï¼Œä¸ä½¿ç”¨ï¼‰:",c.progress),console.log("[pollTaskStatus] å½“å‰è¿›åº¦:",x.value,"é˜¶æ®µ:",E.value,"çŠ¶æ€:",c.status);if("completed"===c.status||"complete"===b){if(console.log("[pollTaskStatus] æ£€æµ‹åˆ°å®ŒæˆçŠ¶æ€ï¼Œstatus:",c.status,"stage:",b,"progress:",c.progress),c.result)return J(),x.value=100,console.log("[pollTaskStatus] å®Œæˆï¼è¿”å› result:",JSON.stringify(c.result)),c.result;if(c.content_id){J(),x.value=100,console.log("[pollTaskStatus] å®Œæˆï¼ˆæ—  resultï¼‰ï¼Œå°è¯•è·å–è¯¦æƒ…ï¼Œcontent_id:",c.content_id);try{const e=await n.getContentDetail(c.content_id);return console.log("[pollTaskStatus] è¯¦æƒ… API è¿”å›:",JSON.stringify(e)),{id:e.id,title:e.title,audio_url:e.audio_url||"",video_url:e.video_url||"",cover_url:e.cover_url||"",suno_cover_url:e.suno_cover_url||"",duration:e.audio_duration||e.total_duration||0,theme_topic:e.theme_topic||(null==(s=v.value)?void 0:s.name)||"",music_style:P.value,lyrics:e.lyrics||"",all_tracks:e.all_tracks||[],personalization:e.personalization||{child_name:(null==(r=t.currentChild)?void 0:r.name)||""},created_at:e.created_at}}catch(_){return console.error("[pollTaskStatus] è·å–è¯¦æƒ…å¤±è´¥:",_),{id:c.content_id,title:(null==(g=v.value)?void 0:g.name)||"å„¿æ­Œ",audio_url:"",duration:0,theme_topic:(null==(i=v.value)?void 0:i.name)||"",music_style:P.value,lyrics:"",personalization:{child_name:(null==(l=t.currentChild)?void 0:l.name)||""},created_at:(new Date).toISOString()}}}console.log("[pollTaskStatus] å®ŒæˆçŠ¶æ€ä½†æ—  result/content_idï¼Œç»§ç»­ç­‰å¾…...")}if("failed"===c.status||"error"===b)throw J(),new Error(c.error||c.message||"ç”Ÿæˆå¤±è´¥");await new Promise(e=>setTimeout(e,d))}catch(m){if(m.message&&(m.message.includes("ç”Ÿæˆå¤±è´¥")||m.message.includes("ç½‘ç»œè¿æ¥å¤±è´¥")))throw m;if(O.value++,console.error(`[pollTaskStatus] è½®è¯¢é”™è¯¯ (${O.value}/${c}):`,m.message||m),O.value>=2&&(M.value=`ç½‘ç»œä¸ç¨³å®šï¼Œæ­£åœ¨é‡è¯•... (${O.value})`),O.value>=c)throw J(),new Error("ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œåé‡è¯•");y<u-1&&await new Promise(e=>setTimeout(e,d))}throw J(),console.error("[pollTaskStatus] è½®è¯¢è¶…æ—¶ï¼Œå·²å°è¯•",u,"æ¬¡"),new Error("ç”Ÿæˆè¶…æ—¶ï¼Œè¯·é‡è¯•")}(u);d&&(A.value=d),x.value=100,M.value="ç”Ÿæˆå®Œæˆï¼",setTimeout(()=>{C.value=!1,A.value&&(console.log("[startGenerate] å­˜å‚¨åˆ°ä¸´æ—¶å­˜å‚¨"),e.index.setStorageSync("temp_nursery_rhyme",A.value),e.index.redirectTo({url:`/pages/play/nursery-rhyme?id=${A.value.id||""}&fromGenerate=1`}))},500)}catch(a){J(),C.value=!1,E.value="error",console.error("[startGenerate] ç”Ÿæˆå„¿æ­Œå¤±è´¥:",a),e.index.showToast({title:a.message||"ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•",icon:"none"})}}())}function J(){I&&(clearInterval(I),I=null)}function V(e){return{pending:"waiting",queued:"waiting",submitted:"waiting",init:"waiting",text:"text",lyrics:"text",TEXT_SUCCESS:"text",first:"first",generating:"first",processing:"first",FIRST_SUCCESS:"first",complete:"complete",completed:"complete",success:"complete",SUCCESS:"complete",done:"complete",error:"error",failed:"error",ERROR:"error"}[e]||e}function Y(){e.index.navigateBack()}return e.onMounted(()=>{const a=e.index.getSystemInfoSync();u.value=a.statusBarHeight||20,d.value=u.value+44}),e.onLoad(e=>{if("smart"===(null==e?void 0:e.creation_mode)&&(null==e?void 0:e.custom_prompt))return g.value=!1,i.value=!0,l.value=decodeURIComponent(e.custom_prompt),e.music_mood&&(k.value=e.music_mood),e.vocal_type&&(S.value=e.vocal_type),v.value={id:"smart_custom",name:"æ™ºèƒ½åˆ›ä½œ",subcategory:"è‡ªå®šä¹‰",age_range:[12,72],keywords:[]},void setTimeout(()=>{_.value=2},100);if(null==e?void 0:e.theme){g.value=!1,i.value=!1;const a=e.theme;return void setTimeout(()=>{for(const e of Object.keys(z)){const o=z[e].find(e=>e.id===a);if(o){y.value=e,v.value=o;break}}},100)}g.value=!0}),(a,o)=>{var n;return e.e({a:e.o(Y),b:u.value+"px",c:d.value+"px",d:g.value},g.value?{e:e.o(D),f:e.p({"content-type":"nursery_rhyme"})}:e.e({g:e.f(c,(a,o,n)=>e.e({a:_.value>o},_.value>o?{}:{b:e.t(o+1)},{c:e.t(a.name),d:a.id,e:_.value>=o?1:"",f:_.value>o?1:""})),h:0===_.value},0===_.value?{i:e.t(j.value),j:e.f(m,(a,o,n)=>({a:e.t(a.icon),b:e.t(a.name),c:a.id,d:y.value===a.id?1:"",e:e.o(e=>y.value=a.id,a.id)})),k:e.f(N.value,(a,o,n)=>{var s,r,t,g;return e.e({a:e.t((g=a.id,B[g]||"ğŸµ")),b:e.t(a.name),c:(null==(s=v.value)?void 0:s.id)===a.id},(null==(r=v.value)||r.id,a.id,{}),{d:a.id,e:(null==(t=v.value)?void 0:t.id)===a.id?1:"",f:e.o(e=>function(e){v.value=e}(a),a.id)})})}:{},{l:1===_.value},1===_.value?e.e({m:e.t(j.value),n:f.value},f.value?{o:e.f(e.unref(b),(a,o,n)=>({a:e.t(a.icon),b:e.t(a.name),c:a.id,d:p.value===a.id?1:"",e:e.o(e=>function(e){p.value=e.id;const a=s.getScenePresetParams(e.id);a.music_mood&&(k.value=a.music_mood),a.vocal_type&&(S.value=a.vocal_type),Object.assign(T,a),console.log("[selectScenePreset] åº”ç”¨é¢„è®¾:",e.name,a)}(a),a.id)}))}:{},{p:e.f(e.unref(w),(a,o,n)=>({a:e.t(a.icon),b:e.t(a.label),c:a.value,d:e.n(a.value),e:e.n({selected:k.value===a.value}),f:e.o(e=>function(e){k.value=e;const a=s.getMoodLinkageParams(e);Object.keys(a).length>0&&(Object.assign(T,a),console.log("[onMoodChange] æ™ºèƒ½è”åŠ¨:",e,a))}(a.value),a.value)})),q:e.f(e.unref(h),(a,o,n)=>({a:e.t(a.icon),b:e.t(a.label),c:a.value,d:S.value===a.value?1:"",e:e.o(e=>S.value=a.value,a.value)})),r:e.o(q),s:e.p({"model-value":T})}):{},{t:2===_.value},2===_.value?e.e({v:i.value},i.value?{w:e.t(l.value)}:{x:e.t(null==(n=v.value)?void 0:n.name)},{y:e.t(j.value),z:e.t(U.value),A:e.t(L.value),B:G.value.length>0},G.value.length>0?{C:e.t(G.value.length),D:e.f(G.value,(a,o,n)=>({a:e.t(a.icon),b:e.t(a.label),c:e.t(a.value),d:o}))}:{}):{}),{E:!g.value},g.value?{}:e.e({F:_.value>0},_.value>0?{G:e.o(F)}:{},{H:e.t(2===_.value?"å¼€å§‹åˆ›ä½œ":"ä¸‹ä¸€æ­¥"),I:$.value?"":1,J:e.o(H)}),{K:C.value},C.value?{L:e.p({progress:x.value,stage:E.value,message:M.value,type:"song"})}:{})}}}),l=e._export_sfc(i,[["__scopeId","data-v-c28ef552"]]);wx.createPage(l);
