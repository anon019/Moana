"use strict";const e=require("../../common/vendor.js"),t=require("../../stores/user.js"),i=require("../../stores/child.js"),n=require("../../api/play.js"),o=e.defineComponent({__name:"index",setup(o){const c=t.useUserStore(),r=i.useChildStore(),d=e.ref([]),a=e.ref(0),s=e.ref(!1),l=e.computed(()=>{var e;return(null==(e=r.currentChild)?void 0:e.name)||"å®è´"}),u=e.computed(()=>{const e=(new Date).getHours();return e<6?"ðŸŒ™":e<9?"ðŸŒ…":e<12?"â˜€ï¸":e<14?"ðŸŒž":e<18?"ðŸŒ¤ï¸":e<22?"ðŸŒ†":"ðŸŒ™"}),p=e.computed(()=>{const e=(new Date).getHours();return e<6?"å¤œæ·±äº†":e<9?"æ—©ä¸Šå¥½":e<12?"ä¸Šåˆå¥½":e<14?"ä¸­åˆå¥½":e<18?"ä¸‹åˆå¥½":e<22?"æ™šä¸Šå¥½":"å¤œæ·±äº†"}),g=e.computed(()=>{const e=r.todayDuration||0;if(!e||e<1)return"0åˆ†é’Ÿ";if(e<60)return`${Math.round(e)}åˆ†é’Ÿ`;const t=Math.floor(e/60),i=Math.round(e%60);return i>0?`${t}å°æ—¶${i}åˆ†`:`${t}å°æ—¶`}),h=[{id:"brush_teeth",icon:"ðŸ¦·",title:"åˆ·ç‰™å¥½ä¹ æƒ¯",desc:"åŸ¹å…»å£è…”æŠ¤ç†ä¹ æƒ¯"},{id:"no_picky_eating",icon:"ðŸ¥¦",title:"ä¸æŒ‘é£Ÿ",desc:"å¥åº·é¥®é£Ÿå¯è’™"},{id:"bedtime",icon:"ðŸ›ï¸",title:"æŒ‰æ—¶ç¡è§‰",desc:"åŸ¹å…»ä½œæ¯è§„å¾‹"},{id:"wash_hands",icon:"ðŸ§¼",title:"æ´—æ‰‹è®²å«ç”Ÿ",desc:"å…»æˆå«ç”Ÿä¹ æƒ¯"},{id:"tidy_up",icon:"ðŸ§¹",title:"æ”¶æ‹¾çŽ©å…·",desc:"å­¦ä¼šè‡ªå·±æ•´ç†"},{id:"greeting",icon:"ðŸ‘‹",title:"æ‰“æ‹›å‘¼",desc:"ç¤¼è²Œå°è¾¾äºº"},{id:"colors",icon:"ðŸŽ¨",title:"è®¤è¯†é¢œè‰²",desc:"è‰²å½©å¯è’™ä¹‹æ—…"},{id:"animals",icon:"ðŸ¦",title:"è®¤è¯†åŠ¨ç‰©",desc:"åŠ¨ç‰©çŽ‹å›½æŽ¢é™©"},{id:"numbers",icon:"ðŸ”¢",title:"è®¤è¯†æ•°å­—",desc:"æ•°å­¦å¯è’™ä¹å›­"},{id:"weather",icon:"ðŸŒ¤ï¸",title:"è®¤è¯†å¤©æ°”",desc:"æ„Ÿå—è‡ªç„¶å¥¥ç§˜"},{id:"sharing",icon:"ðŸ¤",title:"å­¦ä¼šåˆ†äº«",desc:"åˆ†äº«çš„å¿«ä¹"},{id:"family",icon:"ðŸ‘¨â€ðŸ‘©â€ðŸ‘§",title:"è®¤è¯†å®¶äºº",desc:"æ¸©æš–çš„å®¶åº­"}],v=[{id:"brush_teeth",icon:"ðŸ¦·",title:"åˆ·ç‰™æ­Œ",desc:"å”±ç€æ­Œå„¿åˆ·åˆ·ç‰™"},{id:"no_picky_eating",icon:"ðŸ¥¦",title:"ä¸æŒ‘é£Ÿæ­Œ",desc:"åƒè”¬èœèº«ä½“æ£’"},{id:"nap_time",icon:"ðŸ˜´",title:"åˆç¡æ­Œ",desc:"æ¸©æŸ”æ—‹å¾‹åŠ©çœ "},{id:"wash_hands",icon:"ðŸ§¼",title:"æ´—æ‰‹æ­Œ",desc:"ä¸ƒæ­¥æ´—æ‰‹æ³•"},{id:"colors",icon:"ðŸŒˆ",title:"é¢œè‰²æ­Œ",desc:"å”±å‡ºä¸ƒå½©ä¸–ç•Œ"},{id:"animals",icon:"ðŸ¼",title:"åŠ¨ç‰©æ­Œ",desc:"åŠ¨ç‰©å«å£°å¤§åˆå”±"},{id:"numbers",icon:"ðŸ”¢",title:"æ•°å­—æ­Œ",desc:"æ•°å­¦å¯è’™å„¿æ­Œ"},{id:"happy",icon:"ðŸ˜„",title:"å¼€å¿ƒæ­Œ",desc:"å¿«ä¹æ¯ä¸€å¤©"},{id:"vehicles",icon:"ðŸšŒ",title:"äº¤é€šå·¥å…·æ­Œ",desc:"è½¦è½¦ç«è½¦é£žæœº"},{id:"greeting",icon:"ðŸ‘‹",title:"æ‰“æ‹›å‘¼æ­Œ",desc:"ä½ å¥½ã€å†è§"}],y=[{id:"brush_teeth",icon:"ðŸ¦·",title:"åˆ·ç‰™åŠ¨ç”»",desc:"ç»˜æœ¬å˜åŠ¨ç”»"},{id:"animals",icon:"ðŸ¦",title:"åŠ¨ç‰©ä¸–ç•Œ",desc:"åŠ¨æ€æ•…äº‹ä½“éªŒ"},{id:"colors",icon:"ðŸŽ¨",title:"è‰²å½©ä¹‹æ—…",desc:"ç»˜æœ¬åŠ¨ç”»ç‰ˆ"},{id:"bedtime",icon:"ðŸŒ™",title:"æ™šå®‰æ•…äº‹",desc:"ç¡å‰åŠ¨ç”»"},{id:"family",icon:"ðŸ‘¨â€ðŸ‘©â€ðŸ‘§",title:"å®¶åº­æ—¶å…‰",desc:"æ¸©é¦¨å°å‰§åœº"},{id:"sharing",icon:"ðŸ¤",title:"åˆ†äº«ä¹è¶£",desc:"åŠ¨ç”»ç»˜æœ¬"}];function m(e,t){const i=(n=t,()=>(n=(9301*n+49297)%233280)/233280);var n;const o=[...e];for(let c=o.length-1;c>0;c--){const e=Math.floor(i()*(c+1));[o[c],o[e]]=[o[e],o[c]]}return o}function f(){const e=new Date((new Date).getTime()+288e5);return 1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate()}const _=e.computed(()=>{const e=f();return m(h,e).slice(0,2).map(e=>({id:`book_${e.id}`,type:"book",icon:e.icon,title:e.title,desc:e.desc,theme:e.id}))}),b=e.computed(()=>{const e=f()+1e3;return m(v,e).slice(0,2).map(e=>({id:`song_${e.id}`,type:"song",icon:e.icon,title:e.title,desc:e.desc,theme:e.id}))}),x=e.computed(()=>{const e=f()+2e3;return m(y,e).slice(0,2).map(e=>({id:`video_${e.id}`,type:"video",icon:e.icon,title:e.title,desc:e.desc,theme:e.id}))});function T(e){return{picture_book:"ç»˜æœ¬",nursery_rhyme:"å„¿æ­Œ",video:"è§†é¢‘"}[e]||"ç»˜æœ¬"}function w(){e.index.switchTab({url:"/pages/profile/index"})}function k(){e.index.navigateTo({url:"/pages/create/picture-book"})}function $(){e.index.navigateTo({url:"/pages/create/nursery-rhyme"})}function C(){e.index.navigateTo({url:"/pages/create/video"})}function D(){e.index.switchTab({url:"/pages/library/index"})}function M(){s.value=!1,e.index.navigateTo({url:"/pages/profile/add-child"})}function j(t){console.log("[é¦–é¡µçµæ„Ÿ] ç‚¹å‡»æŽ¨è:",t.type,t.title,"ä¸»é¢˜ID:",t.theme),"book"===t.type?e.index.navigateTo({url:`/pages/create/picture-book?theme=${t.theme}`}):"song"===t.type?e.index.navigateTo({url:`/pages/create/nursery-rhyme?theme=${t.theme}`}):"video"===t.type&&e.index.navigateTo({url:"/pages/create/video"})}function q(){e.index.navigateTo({url:"/pages/child/index"})}function P(){e.index.navigateTo({url:"/pages/settings/index"})}function S(){e.index.switchTab({url:"/pages/library/index"})}function H(){e.index.navigateTo({url:"/pages/settings/index"})}async function I(){if(c.checkLogin()||await c.login(),await r.fetchChildren(),r.hasChild){if(r.currentChild)try{const[e,t]=await Promise.all([n.getPlayHistory(r.currentChild.id,{limit:5}),n.getPlayStats(r.currentChild.id)]);d.value=e.items.filter(e=>e.progress<1),a.value=t.streak_days,r.todayDuration=t.today_duration}catch(e){console.log("åŠ è½½æ•°æ®å¤±è´¥:",e)}}else s.value=!0}return e.onMounted(I),e.onShow(I),(t,i)=>{var n,o;return e.e({a:null==(n=e.unref(r).currentChild)?void 0:n.avatar_url},(null==(o=e.unref(r).currentChild)?void 0:o.avatar_url)?{b:e.unref(r).currentChild.avatar_url}:{c:e.t(l.value.slice(0,1))},{d:e.t(u.value),e:e.t(p.value),f:e.t(l.value),g:e.o(w),h:e.t(g.value),i:e.t(a.value),j:e.t(l.value),k:e.o(k),l:e.o($),m:e.o(C),n:d.value.length>0},d.value.length>0?{o:e.o(D),p:e.f(d.value,(t,i,n)=>{return e.e({a:t.cover_url},t.cover_url?{b:t.cover_url}:{c:e.t((o=t.content_type,{picture_book:"ðŸ“š",nursery_rhyme:"ðŸŽµ",video:"ðŸŽ¬"}[o]||"ðŸ“š"))},{d:t.progress,e:e.t(Math.round(100*t.progress)),f:e.t(t.content_title),g:e.t(T(t.content_type)),h:e.n("type-"+t.content_type),i:t.id,j:e.n("continue-"+t.content_type),k:e.o(i=>function(t){const i=t.content_type;"nursery_rhyme"===i?e.index.navigateTo({url:`/pages/play/nursery-rhyme?id=${t.content_id}`}):"video"===i?e.index.navigateTo({url:`/pages/play/video?id=${t.content_id}`}):e.index.navigateTo({url:`/pages/play/picture-book?id=${t.content_id}`})}(t),t.id)});var o})}:{},{q:e.f(_.value,(t,i,n)=>({a:e.t(t.icon),b:e.t(t.title),c:e.t(t.desc),d:t.id,e:e.o(e=>j(t),t.id)})),r:e.f(b.value,(t,i,n)=>({a:e.t(t.icon),b:e.t(t.title),c:e.t(t.desc),d:t.id,e:e.o(e=>j(t),t.id)})),s:e.f(x.value,(t,i,n)=>({a:e.t(t.icon),b:e.t(t.title),c:e.t(t.desc),d:t.id,e:e.o(e=>j(t),t.id)})),t:e.o(q),v:e.o(P),w:e.o(S),x:e.o(H),y:s.value},s.value?{z:e.o(M),A:e.o(()=>{})}:{})}}}),c=e._export_sfc(o,[["__scopeId","data-v-9a865b4a"]]);wx.createPage(c);
