"use strict";const e=require("../common/vendor.js"),t="moana_cache_";const r=new class{getKey(e){return t+e.replace(/[^a-zA-Z0-9]/g,"_").slice(0,100)}get(t){try{const r=this.getKey(t),n=e.index.getStorageSync(r);return n?Date.now()>n.expireAt?(this.remove(t),null):n.value:null}catch(r){return null}}set(t,r,n=3e5){try{const c=this.getKey(t),a={value:r,expireAt:Date.now()+n};return e.index.setStorageSync(c,a),!0}catch(c){return console.warn("[Cache] 写入失败:",c),!1}}remove(t){try{e.index.removeStorageSync(this.getKey(t))}catch(r){}}clear(){try{e.index.getStorageInfoSync().keys.forEach(r=>{r.startsWith(t)&&e.index.removeStorageSync(r)})}catch(r){console.warn("[Cache] 清空失败:",r)}}};exports.cache=r;
